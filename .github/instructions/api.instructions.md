# API開発専用指示 (API Development Instructions)

## プロジェクト構造（Project Structure）
このディレクトリはKotlin Spring Boot WebFluxを使用したAPIプロジェクトです：
- `api/` ディレクトリにメインのAPIコードが含まれています
- Gradle Kotlin DSLを使用してビルド設定を管理しています
- WebFluxとコルーチンを使用した非同期プログラミングを採用しています

## セキュリティベストプラクティス（Security Best Practices）

### コード提案時の考慮事項
- **入力値検証**: 全ての外部入力に対して適切な検証を実装してください
- **SQLインジェクション対策**: データベースクエリではパラメータ化クエリを使用してください
- **機密情報の保護**: API キー、パスワード、その他の機密情報をハードコーディングしないでください
- **ログ出力**: 機密情報をログに出力しないよう注意してください

## パフォーマンスと保守性（Performance and Maintainability）

### パフォーマンス指針
- **非同期処理**: WebFluxとコルーチンを活用した非ブロッキング処理を推奨します
- **効率的なデータ処理**: Streamやシーケンスを適切に使用してメモリ効率を考慮してください
- **キャッシュ戦略**: 適切な場所でキャッシュの実装を提案してください
- **データベース最適化**: N+1問題の回避やクエリ最適化を考慮してください

### コード品質と保守性
- **単一責任原則**: 各クラス・関数は単一の責任を持つよう設計してください
- **依存性注入**: Spring DIコンテナを適切に活用してください
- **イミュータブル設計**: 可能な限りデータクラスをimmutableに設計してください
- **関数型プログラミング**: Kotlinの関数型機能を活用してください

## テスト開発（Testing Development）

### テスト指針（Testing Guidelines）

#### ユニットテスト
- **テストケース命名**: 日本語でテストの意図を明確に表現してください
- **テストデータ**: 意味のあるテストデータを使用してください
- **モック使用**: 外部依存をモックして単体テストの独立性を保ってください
- **例外テスト**: 正常系だけでなく異常系のテストも実装してください

#### テストコード品質
- **可読性**: テストコードは仕様書の役割も果たすため、意図が明確に伝わるように記述してください
- **保守性**: テスト対象コードの変更に対して適切に追従できるよう、疎結合なテスト設計を心がけてください
- **独立性**: テスト間の依存関係を排除し、単独で実行可能なテストを作成してください

#### Spring Boot テスト
- **@SpringBootTest**: 統合テストでアプリケーションコンテキスト全体をテストする場合に使用
- **@WebFluxTest**: WebFluxコントローラーの単体テストに使用
- **@DataR2dbcTest**: R2DBCリポジトリのテストに使用
- **TestContainers**: データベースなど外部リソースが必要な場合は積極的に活用

## ドキュメンテーション（Documentation）

### ドキュメンテーション標準（Documentation Standards）

#### コメント記述
- **KDoc**: パブリックなAPI要素にはKDocコメントを必ず記述してください
- **複雑なロジック**: 複雑なビジネスロジックには日本語で詳細な説明を追加してください
- **TODO/FIXME**: 将来の改善点や既知の問題を明記してください

#### API ドキュメント
- **OpenAPI/Swagger**: REST API の仕様書は自動生成を活用してください
- **エンドポイント説明**: 各エンドポイントの目的、パラメータ、レスポンス例を明記してください
- **エラーハンドリング**: 想定されるエラーケースとその対処法を文書化してください

これらの指針に従って、高品質で保守性が高く、セキュリティを考慮したKotlin Spring Bootアプリケーションの開発を支援してください。